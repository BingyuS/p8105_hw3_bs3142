---
title: "p8105_hw3_bs3142"
author: "Bingyu Sun"
date: "10/7/2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_bw() + theme(legend.position = "bottom"))
```

## Problem 1

#### Section 1: Data import

```{r import brfss data}
library(p8105.datasets)
data(brfss_smart2010)
```

#### Section 2: Data Manipulation

```{r}
brfss_data =
  brfss_smart2010 %>%
  janitor::clean_names() %>%
  filter(topic == "Overall Health") %>%
  select(-(class:question), -sample_size, -(confidence_limit_low:geo_location)) %>%
  mutate(response = factor(response))

str(brfss_data)
```

#### Section 3: Q & A

**1. In 2002, which states were observed at 7 locations?**

```{r}
brfss_data %>%
  filter(year == 2002) %>%
  group_by(locationabbr) %>%
  summarize(n_obs = n_distinct(locationdesc))
```

**CT, FL, NC** were observed at 7 locations.

**2. Make a “spaghetti plot” that shows the number of observations in each state from 2002 to 2010.**

```{r}
brfss_data %>%
  group_by(year, locationabbr) %>%
  summarize(n_obs = n_distinct(locationdesc)) %>%
  ggplot(aes(x = year, y = n_obs, color = locationabbr)) + 
    geom_line() +
    labs(
      title = "Number of observations in each state 2002-2010",
      x = "Year",
      y = "Number of observations",
      caption = "Data from brfss_smart2010"
  ) +
  viridis::scale_color_viridis(
    name = "State", 
    discrete = TRUE
  )
```

**3. Make a table showing, for the years 2002, 2006, and 2010, the mean and standard deviation of the proportion of “Excellent” responses across locations in NY State.**

```{r}
brfss_data %>%
  filter(year %in% c("2002", "2006", "2010"), response == "Excellent", locationabbr == "NY") %>%
  spread(key = response, value = data_value) %>%
  group_by(year) %>%
  summarize(
    mean_prop_excellent_NY = mean(Excellent, na.rm = TRUE),
    sd_prop_excellent_NY = sd(Excellent, na.rm = TRUE)
  ) %>%
  knitr::kable(digits = 1)
```


**4. For each year and state, compute the average proportion in each response category (taking the average across locations in a state). Make a five-panel plot that shows, for each response category separately, the distribution of these state-level averages over time.**

```{r}
brfss_data %>%
  group_by(year, locationabbr, response) %>%
  summarize(mean_prop_response = mean(data_value))
```
????????

## Problem 2

#### Section 1: Data import

```{r}
data(instacart)
```

#### Section 2: Data exploration

```{r}

```

**Summary**


#### Section 3: Q & A

**1. How many aisles are there, and which aisles are the most items ordered from?**

```{r}
instacart %>%
  summarize(
    n_aisle = n_distinct(aisle),
    max_items = max(add_to_cart_order))
```

There are **134** aisles. **nuts seeds dried fruit** and **packaged vegetables fruits**
Which aisles are the most items ordered from?????

**2. Make a plot that shows the number of items ordered in each aisle. Order aisles sensibly, and organize your plot so others can read it.**

```{r}
instacart %>%
  distinct(aisle, add_to_cart_order)
```
?????????

**3. Make a table showing the most popular item aisles “baking ingredients”, “dog food care”, and “packaged vegetables fruits”.**

```{r}
instacart 
```

